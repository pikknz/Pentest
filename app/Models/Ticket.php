<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Database\Eloquent\Model;

class Ticket extends Model
{
    use HasFactory;
    protected $table = 'tickets';
    public static function topUserName(): string
    {
        return 'Noel';
    }

    public static function getLastTicketProcessingTime(): string
    {
        return Ticket::select('updated_at')->orderBy('updated_at','DESC')->limit(1)->get();
    }

    public static function getOpenTicketCount(): string
    {
        return count(Ticket::where('status', '=', 0)->get());
    }

    public static function getTotalTicketCount(): string
    {
        return count(Ticket::all());
    }

    public static function getStats(): string
    {
        $stats = [];
        $stats['totalTickets'] = count(Ticket::all());
        $stats['unprocessedTickets'] = Ticket::getOpenTicketCount();
        $stats['topUserName'] = Ticket::getStats();
        $stats['lastTicketProcessingTime'] = Ticket::getTastTicketProcessingTime();
        return $stats;
    }
}
